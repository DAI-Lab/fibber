
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Data Format &#8212; fibber 0.4.0 documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/css/blank.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="_static/dai-logo-white.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Benchmark" href="benchmark.html" />
    <link rel="prev" title="Fibber" href="readme.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="index.html">
  <img src="_static/dai-logo-white-200.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="readme.html">
  Fibber
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  Data Format
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="benchmark.html">
  Benchmark
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="api/fibber.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="contributing.html">
  Contributing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="authors.html">
  Credits
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="history.html">
  History
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/dai-lab/fibber" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dataset-format">
   Dataset format
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-datasets">
     Download datasets
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#output-format">
   Output format
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intermediate-result">
     Intermediate result
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#result-with-metrics">
     Result with metrics
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="data-format">
<h1>Data Format<a class="headerlink" href="#data-format" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dataset-format">
<h2>Dataset format<a class="headerlink" href="#dataset-format" title="Permalink to this headline">¶</a></h2>
<p>Each dataset is stored in multiple JSON files. For example, the ag dataset is stored in <code class="docutils literal notranslate"><span class="pre">train.json</span></code> and <code class="docutils literal notranslate"><span class="pre">test.json</span></code>.</p>
<p>The JSON file contains the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">label_mapping</span></code>: a list of strings. The <code class="docutils literal notranslate"><span class="pre">label_mapping</span></code> maps an integer label to the actual meaning of that label. This list is not used in the algorithm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cased</span></code>: a bool value indicates if it is a cased dataset or uncased dataset. Sentences in uncased datasets are all in lowercase.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">paraphrase_field</span></code>: choose from <code class="docutils literal notranslate"><span class="pre">text0</span></code> and <code class="docutils literal notranslate"><span class="pre">text1</span></code>. <code class="docutils literal notranslate"><span class="pre">Paraphrase_field</span></code> indicates which sentence in each data record should be paraphrased.</p></li>
<li><p><cite>data</cite>: a list of data records. Each data records contains:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code>: an integer indicating the classification label of the text.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">text0</span></code>:</p>
<ul>
<li><p>For topic and sentiment classification datasets, text0 stores the text to be classified.</p></li>
<li><p>For natural language inference datasets, text0 stores the premise.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">text1</span></code>:</p>
<ul>
<li><p>For topic and sentiment classification datasets, this field is omitted.</p></li>
<li><p>For natural language inference datasets, text1 stores the hypothesis.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>A topic / sentiment classification example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;label_mapping&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;World&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sports&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Business&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sci/Tech&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;cased&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;paraphrase_field&quot;</span><span class="p">:</span> <span class="s2">&quot;text0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;text0&quot;</span><span class="p">:</span> <span class="s2">&quot;Boston won the NBA championship in 2008.&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;text0&quot;</span><span class="p">:</span> <span class="s2">&quot;Apple releases its latest cell phone.&quot;</span>
    <span class="p">},</span>
    <span class="o">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A natural langauge inference example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;label_mapping&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;neutral&quot;</span><span class="p">,</span>
    <span class="s2">&quot;entailment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;contradiction&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;cased&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;paraphrase_field&quot;</span><span class="p">:</span> <span class="s2">&quot;text1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;text0&quot;</span><span class="p">:</span> <span class="s2">&quot;A person on a horse jumps over a broken down airplane.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text1&quot;</span><span class="p">:</span> <span class="s2">&quot;A person is training his horse for a competition.&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;text0&quot;</span><span class="p">:</span> <span class="s2">&quot;A person on a horse jumps over a broken down airplane.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text1&quot;</span><span class="p">:</span> <span class="s2">&quot;A person is at a diner, ordering an omelette.&quot;</span>
    <span class="p">},</span>
    <span class="o">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="download-datasets">
<h3>Download datasets<a class="headerlink" href="#download-datasets" title="Permalink to this headline">¶</a></h3>
<p>We have scripts to help you easily download all datasets. We provide two options to download datasets:</p>
<p><strong>Download data preprocessed by us.</strong></p>
<p>We preprocessed datasets and uploaded them to AWS. You can use the following command to download all datasets.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">fibber</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">download_datasets</span>
</pre></div>
</div>
<p>After executing the command, the dataset is stored at <code class="docutils literal notranslate"><span class="pre">~/.fibber/datasets/&lt;dataset_name&gt;/*.json</span></code>. For example, the ag dataset is stored in <code class="docutils literal notranslate"><span class="pre">~/.fibber/datasets/ag/</span></code>. And there will be two sets <code class="docutils literal notranslate"><span class="pre">train.json</span></code> and <code class="docutils literal notranslate"><span class="pre">test.json</span></code> in the folder.</p>
<p><strong>Download and process data from the original source.</strong></p>
<p>You can also download the original dataset version and process it locally.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">fibber</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">download_datasets</span> <span class="o">--</span><span class="n">process_raw</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This script will download data from the original source to <code class="docutils literal notranslate"><span class="pre">~/.fibber/datasets/&lt;dataset_name&gt;/raw/</span></code> folder. And process the raw data to generate the JSON files.</p>
</div>
</div>
<div class="section" id="output-format">
<h2>Output format<a class="headerlink" href="#output-format" title="Permalink to this headline">¶</a></h2>
<p>During the benchmark process, we save results in several files.</p>
<div class="section" id="intermediate-result">
<h3>Intermediate result<a class="headerlink" href="#intermediate-result" title="Permalink to this headline">¶</a></h3>
<p>The intermediate result <code class="docutils literal notranslate"><span class="pre">&lt;output_dir&gt;/&lt;dataset&gt;-&lt;strategy&gt;-&lt;date&gt;-&lt;time&gt;-tmp.json</span></code> stores the paraphrased sentences. Strategies can run for a few minutes (hours) on some datasets, so we save the result every 30 seconds. The file format is similar to the dataset file. For each data record, we add a new field, <code class="docutils literal notranslate"><span class="pre">text0_paraphrases</span></code> or <code class="docutils literal notranslate"><span class="pre">text1_paraphrases</span></code> depending the <code class="docutils literal notranslate"><span class="pre">paraphrase_field</span></code>.</p>
<p>An example is as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;label_mapping&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;World&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sports&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Business&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sci/Tech&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;cased&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;paraphrase_field&quot;</span><span class="p">:</span> <span class="s2">&quot;text0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;text0&quot;</span><span class="p">:</span> <span class="s2">&quot;Boston won the NBA championship in 2008.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text0_paraphrases&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;The 2008 NBA championship is won by Boston.&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="o">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="result-with-metrics">
<h3>Result with metrics<a class="headerlink" href="#result-with-metrics" title="Permalink to this headline">¶</a></h3>
<p>The result <code class="docutils literal notranslate"><span class="pre">&lt;output_dir&gt;/&lt;dataset&gt;-&lt;strategy&gt;-&lt;date&gt;-&lt;time&gt;-with-metrics.json</span></code> stores the paraphrased sentences as well as metrics. Compute metrics may need a few minutes on some datasets, so we save the result every 30 seconds. The file format is similar to the intermediate file. For each data record, we add two new field, <code class="docutils literal notranslate"><span class="pre">original_text_metrics</span></code> and <code class="docutils literal notranslate"><span class="pre">paraphrase_metrics</span></code>.</p>
<p>An example is as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;label_mapping&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;World&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sports&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Business&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sci/Tech&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;cased&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;paraphrase_field&quot;</span><span class="p">:</span> <span class="s2">&quot;text0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;text0&quot;</span><span class="p">:</span> <span class="s2">&quot;Boston won the NBA championship in 2008.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;text0_paraphrases&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
      <span class="s2">&quot;original_text_metrics&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;EditDistanceMetric&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;USESemanticSimilarityMetric&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;GloVeSemanticSimilarityMetric&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;GPT2GrammarQualityMetric&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;BertClassifier&quot;</span><span class="p">:</span> <span class="mi">1</span>
      <span class="p">},</span>
      <span class="s2">&quot;paraphrase_metrics&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;EditDistanceMetric&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
          <span class="s2">&quot;USESemanticSimilarityMetric&quot;</span><span class="p">:</span> <span class="mf">0.91</span><span class="p">,</span>
          <span class="s2">&quot;GloVeSemanticSimilarityMetric&quot;</span><span class="p">:</span> <span class="mf">0.94</span><span class="p">,</span>
          <span class="s2">&quot;GPT2GrammarQualityMetric&quot;</span><span class="p">:</span> <span class="mf">2.3</span><span class="p">,</span>
          <span class="s2">&quot;BertClassifier&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="o">...</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="o">...</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">original_text_metrics</span></code> stores a dict of several metrics. It compares the original text against itself. The <code class="docutils literal notranslate"><span class="pre">paraphrase_metrics</span></code> is a list of the same length as paraphrases in this data record. Each element in this list is a dict showing the comparison between the original text and one paraphrased text.</p>
</div>
</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="readme.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Fibber</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="benchmark.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Benchmark</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020, MIT Data To AI Lab.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>