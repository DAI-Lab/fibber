
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fibber.metrics package &#8212; fibber 0.1.1 documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/dai-logo-white.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="fibber.metrics.bert_clf_prediction module" href="fibber.metrics.bert_clf_prediction.html" />
    <link rel="prev" title="fibber.datasets.preprocess_yelp module" href="fibber.datasets.preprocess_yelp.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <img src="../_static/dai-logo-white-200.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../readme.html">Fibber</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../benchmark.html">Benchmark</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="fibber.html">API Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../contributing.html">Contributing</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../authors.html">Credits</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../history.html">History</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/dai-lab/fibber" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="fibber.benchmark.html">fibber.benchmark package</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.datasets.html">fibber.datasets package</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="">fibber.metrics package</a>
                    <ul>
                    
                        <li class="">
                            <a href="fibber.metrics.bert_clf_prediction.html">fibber.metrics.bert_clf_prediction module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.editing_distance.html">fibber.metrics.editing_distance module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.glove_semantic_similarity.html">fibber.metrics.glove_semantic_similarity module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.gpt2_grammar_quality.html">fibber.metrics.gpt2_grammar_quality module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.metric_base.html">fibber.metrics.metric_base module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.metric_utils.html">fibber.metrics.metric_utils module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.use_semantic_similarity.html">fibber.metrics.use_semantic_similarity module</a>
                        </li>
                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.paraphrase_strategies.html">fibber.paraphrase_strategies package</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.resources.html">fibber.resources package</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.download_utils.html">fibber.download_utils module</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.fibber.html">fibber.fibber module</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.log.html">fibber.log module</a>
                </li>
            
          
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#submodules" class="nav-link">Submodules</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#module-fibber.metrics" class="nav-link">Module contents</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="fibber-metrics-package">
<h1>fibber.metrics package<a class="headerlink" href="#fibber-metrics-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="fibber.metrics.bert_clf_prediction.html">fibber.metrics.bert_clf_prediction module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fibber.metrics.editing_distance.html">fibber.metrics.editing_distance module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fibber.metrics.glove_semantic_similarity.html">fibber.metrics.glove_semantic_similarity module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fibber.metrics.gpt2_grammar_quality.html">fibber.metrics.gpt2_grammar_quality module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fibber.metrics.metric_base.html">fibber.metrics.metric_base module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fibber.metrics.metric_utils.html">fibber.metrics.metric_utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fibber.metrics.use_semantic_similarity.html">fibber.metrics.use_semantic_similarity module</a></li>
</ul>
</div>
</div>
<div class="section" id="module-fibber.metrics">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-fibber.metrics" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="fibber.metrics.BertClfPrediction">
<em class="property">class </em><code class="sig-prename descclassname">fibber.metrics.</code><code class="sig-name descname">BertClfPrediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset_name</span></em>, <em class="sig-param"><span class="n">trainset</span></em>, <em class="sig-param"><span class="n">testset</span></em>, <em class="sig-param"><span class="n">bert_gpu_id</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">bert_clf_steps</span><span class="o">=</span><span class="default_value">20000</span></em>, <em class="sig-param"><span class="n">bert_clf_bs</span><span class="o">=</span><span class="default_value">32</span></em>, <em class="sig-param"><span class="n">bert_clf_lr</span><span class="o">=</span><span class="default_value">2e-05</span></em>, <em class="sig-param"><span class="n">bert_clf_optimizer</span><span class="o">=</span><span class="default_value">'adamw'</span></em>, <em class="sig-param"><span class="n">bert_clf_weight_decay</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">bert_clf_period_summary</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">bert_clf_period_val</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">bert_clf_period_save</span><span class="o">=</span><span class="default_value">5000</span></em>, <em class="sig-param"><span class="n">bert_clf_val_steps</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.BertClfPrediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fibber.metrics.metric_base.html#fibber.metrics.metric_base.MetricBase" title="fibber.metrics.metric_base.MetricBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">fibber.metrics.metric_base.MetricBase</span></code></a></p>
<p>BERT classifier prediction on paraphrases.</p>
<p>This metric is special, it does not compare the original and paraphrased sentence.
Instead, it outputs the classifier prediction on paraphrases. So we should not compute
mean or std on this metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_name</strong> (<em>str</em>) – the name of the dataset.</p></li>
<li><p><strong>trainset</strong> (<em>dict</em>) – a fibber dataset.</p></li>
<li><p><strong>testset</strong> (<em>dict</em>) – a fibber dataset.</p></li>
<li><p><strong>bert_gpu_id</strong> (<em>int</em>) – the gpu id for BERT model. Set -1 to use CPU.</p></li>
<li><p><strong>bert_clf_steps</strong> (<em>int</em>) – steps to train a classifier.</p></li>
<li><p><strong>bert_clf_bs</strong> (<em>int</em>) – the batch size.</p></li>
<li><p><strong>bert_clf_lr</strong> (<em>float</em>) – the learning rate.</p></li>
<li><p><strong>bert_clf_optimizer</strong> (<em>str</em>) – the optimizer name.</p></li>
<li><p><strong>bert_clf_weight_decay</strong> (<em>float</em>) – the weight decay in the optimizer.</p></li>
<li><p><strong>bert_clf_period_summary</strong> (<em>int</em>) – the period in steps to write training summary.</p></li>
<li><p><strong>bert_clf_period_val</strong> (<em>int</em>) – the period in steps to run validation and write validation
summary.</p></li>
<li><p><strong>bert_clf_period_save</strong> (<em>int</em>) – the period in steps to save current model.</p></li>
<li><p><strong>bert_clf_val_steps</strong> (<em>int</em>) – number of batched in each validation.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="fibber.metrics.BertClfPrediction.measure_batch">
<code class="sig-name descname">measure_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrases</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction.measure_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.BertClfPrediction.measure_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the metric on a batch of paraphrases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – the original text.</p></li>
<li><p><strong>paraphrases</strong> (<em>list</em>) – a set of paraphrases.</p></li>
<li><p><strong>data_record</strong> (<em>dict</em>) – the corresponding data record of original text.</p></li>
<li><p><strong>paraphrase_field</strong> (<em>str</em>) – the field name to paraphrase.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list containing the metric for each paraphrase.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fibber.metrics.BertClfPrediction.measure_example">
<code class="sig-name descname">measure_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrase</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction.measure_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.BertClfPrediction.measure_example" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="fibber.metrics.BertClfPrediction.predict_batch">
<code class="sig-name descname">predict_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span></em>, <em class="sig-param"><span class="n">context</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction.predict_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.BertClfPrediction.predict_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the prediction of the BERT prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>[</em><em>str</em><em>]</em>) – a list of strs to be classified.</p></li>
<li><p><strong>context</strong> (<em>str</em><em> or </em><em>None</em>) – On regular classification datasets, context is None.
On NLI datasets, context contains the premise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the prediction of the classifier.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fibber.metrics.BertClfPrediction.predict_dist_batch">
<code class="sig-name descname">predict_dist_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span></em>, <em class="sig-param"><span class="n">context</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction.predict_dist_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.BertClfPrediction.predict_dist_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get log probability of the BERT prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>[</em><em>str</em><em>]</em>) – a list of strs to be classified.</p></li>
<li><p><strong>context</strong> (<em>str</em><em> or </em><em>None</em>) – On regular classification datasets, context is None.
On NLI datasets, context contains the premise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array of the unnormalized log probability over on each category.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(np.array)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="fibber.metrics.EditingDistance">
<em class="property">class </em><code class="sig-prename descclassname">fibber.metrics.</code><code class="sig-name descname">EditingDistance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">editing_distance_ignore_punctuation</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/editing_distance.html#EditingDistance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.EditingDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fibber.metrics.metric_base.html#fibber.metrics.metric_base.MetricBase" title="fibber.metrics.metric_base.MetricBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">fibber.metrics.metric_base.MetricBase</span></code></a></p>
<p>This class measures the editing distance between two sentences.</p>
<p>Initialize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>editing_distance_ignore_punctuation</strong> (<em>bool</em>) – whether to ignore punctuation when
computing editing distance.</p>
</dd>
</dl>
<dl class="py method">
<dt id="fibber.metrics.EditingDistance.measure_example">
<code class="sig-name descname">measure_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrase</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/editing_distance.html#EditingDistance.measure_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.EditingDistance.measure_example" title="Permalink to this definition">¶</a></dt>
<dd><p>compute editing distance between original and parapharse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – original text.</p></li>
<li><p><strong>paraphrase</strong> (<em>str</em>) – paraphrased text.</p></li>
<li><p><strong>data_record</strong> – ignored.</p></li>
<li><p><strong>paraphrase_field</strong> – ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the editing distance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(int)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="fibber.metrics.GPT2GrammarQuality">
<em class="property">class </em><code class="sig-prename descclassname">fibber.metrics.</code><code class="sig-name descname">GPT2GrammarQuality</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gpt2_pretrained_model</span><span class="o">=</span><span class="default_value">'gpt2-medium'</span></em>, <em class="sig-param"><span class="n">gpt2_gpu_id</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/gpt2_grammar_quality.html#GPT2GrammarQuality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.GPT2GrammarQuality" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fibber.metrics.metric_base.html#fibber.metrics.metric_base.MetricBase" title="fibber.metrics.metric_base.MetricBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">fibber.metrics.metric_base.MetricBase</span></code></a></p>
<p>This metric computes the perplexity of paraphrased text divided by the perplexity of
original text. The perplexity is measured using GPT2 model.</p>
<p>Initialize GPT2 model.</p>
<dl class="py method">
<dt id="fibber.metrics.GPT2GrammarQuality.measure_batch">
<code class="sig-name descname">measure_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrases</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/gpt2_grammar_quality.html#GPT2GrammarQuality.measure_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.GPT2GrammarQuality.measure_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the metric on a batch of paraphrases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – the original text.</p></li>
<li><p><strong>paraphrases</strong> (<em>list</em>) – a set of paraphrases.</p></li>
<li><p><strong>data_record</strong> (<em>dict</em>) – the corresponding data record of original text.</p></li>
<li><p><strong>paraphrase_field</strong> (<em>str</em>) – the field name to paraphrase.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list containing the USE similarity metric for each paraphrase.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fibber.metrics.GPT2GrammarQuality.measure_example">
<code class="sig-name descname">measure_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrase</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/gpt2_grammar_quality.html#GPT2GrammarQuality.measure_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.GPT2GrammarQuality.measure_example" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the perplexity ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – original text.</p></li>
<li><p><strong>paraphrase</strong> (<em>str</em>) – paraphrased text.</p></li>
<li><p><strong>data_record</strong> – ignored.</p></li>
<li><p><strong>paraphrase_field</strong> – ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="fibber.metrics.GloVeSemanticSimilarity">
<em class="property">class </em><code class="sig-prename descclassname">fibber.metrics.</code><code class="sig-name descname">GloVeSemanticSimilarity</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/glove_semantic_similarity.html#GloVeSemanticSimilarity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.GloVeSemanticSimilarity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fibber.metrics.metric_base.html#fibber.metrics.metric_base.MetricBase" title="fibber.metrics.metric_base.MetricBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">fibber.metrics.metric_base.MetricBase</span></code></a></p>
<p>This metric computes the cosine similarity between two sentences.</p>
<p>Initialize, load Glove embeddings.</p>
<dl class="py method">
<dt id="fibber.metrics.GloVeSemanticSimilarity.measure_example">
<code class="sig-name descname">measure_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrase</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/glove_semantic_similarity.html#GloVeSemanticSimilarity.measure_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.GloVeSemanticSimilarity.measure_example" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Glove cosine similarity between two sentences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – original text.</p></li>
<li><p><strong>paraphrase</strong> (<em>str</em>) – paraphrased text.</p></li>
<li><p><strong>data_record</strong> – ignored.</p></li>
<li><p><strong>paraphrase_field</strong> – ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="fibber.metrics.MetricBase">
<em class="property">class </em><code class="sig-prename descclassname">fibber.metrics.</code><code class="sig-name descname">MetricBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/metric_base.html#MetricBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.MetricBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for Metrics.</p>
<p>All metrics should be derived from this class.</p>
<p>To implement a new metric, you should at least overwrite the <code class="docutils literal notranslate"><span class="pre">measure_example</span></code> method.</p>
<p>The simplest metric can be directly computed from a pair of text, in this case, the metric
can use the <code class="docutils literal notranslate"><span class="pre">origin</span></code> and <code class="docutils literal notranslate"><span class="pre">paraphrase</span></code> args directly.</p>
<p>Other metrics need more information from the data record. For example, <code class="docutils literal notranslate"><span class="pre">text0</span></code>, <code class="docutils literal notranslate"><span class="pre">text1</span></code>,
or <code class="docutils literal notranslate"><span class="pre">label</span></code>. Thus the <code class="docutils literal notranslate"><span class="pre">data_record</span></code> and <code class="docutils literal notranslate"><span class="pre">paraphrase_field</span></code> are also provided as args.</p>
<p>Some metrics may run more efficiently on a batch of data. In this case, you should overwrite
the <code class="docutils literal notranslate"><span class="pre">measure_batch</span></code> function. If you don’t overwrite batch_call, it will compute the metric
of paraphrases one by one.</p>
<dl class="py method">
<dt id="fibber.metrics.MetricBase.measure_batch">
<code class="sig-name descname">measure_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrases</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/metric_base.html#MetricBase.measure_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.MetricBase.measure_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the metric on a batch of paraphrases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – the original text.</p></li>
<li><p><strong>paraphrases</strong> (<em>list</em>) – a set of paraphrases.</p></li>
<li><p><strong>data_record</strong> (<em>dict</em>) – the corresponding data record of original text.</p></li>
<li><p><strong>paraphrase_field</strong> (<em>str</em>) – the field name to paraphrase.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list containing the metric for each paraphrase.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fibber.metrics.MetricBase.measure_example">
<code class="sig-name descname">measure_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrase</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/metric_base.html#MetricBase.measure_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.MetricBase.measure_example" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="fibber.metrics.MetricBundle">
<em class="property">class </em><code class="sig-prename descclassname">fibber.metrics.</code><code class="sig-name descname">MetricBundle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">use_editing_distance</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_use_semantic_similarity</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_glove_semantic_similarity</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_gpt2_grammar_quality</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">use_bert_clf_prediction</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">customized_metrics</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/metric_utils.html#MetricBundle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.MetricBundle" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>MetricBundle can help easily initialize and compute multiple metrics.</p>
<p>Initialize various metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_editing_distance</strong> (<em>bool</em>) – whether to use editing distance in the bundle.</p></li>
<li><p><strong>use_use_semantic_similarity</strong> (<em>bool</em>) – whether to use Universal sentence encoder to
compute sentence similarity</p></li>
<li><p><strong>use_glove_semantic_similarity</strong> (<em>bool</em>) – whether to use Glove embeddings to compute
sentence similarity.</p></li>
<li><p><strong>use_gpt2_grammar_quality</strong> (<em>bool</em>) – whether to use GPT2 to compute sentence quality.</p></li>
<li><p><strong>use_bert_clf_prediction</strong> (<em>bool</em>) – whether to include BERT classifier prediction in
metrics.</p></li>
<li><p><strong>customized_metrics</strong> (<em>list</em>) – a list of customized metrics.</p></li>
<li><p><strong>kargs</strong> – arguments for metrics. kargs will be passed to all metrics.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="fibber.metrics.MetricBundle.get_classifier_for_attack">
<code class="sig-name descname">get_classifier_for_attack</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/metric_utils.html#MetricBundle.get_classifier_for_attack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.MetricBundle.get_classifier_for_attack" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the classifier for attack.</p>
</dd></dl>

<dl class="py method">
<dt id="fibber.metrics.MetricBundle.get_metric">
<code class="sig-name descname">get_metric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">metric_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/metric_utils.html#MetricBundle.get_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.MetricBundle.get_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a metric in the bundle using the metric name.</p>
<p>Metric name is the class name of a metric.</p>
<p>Raises assertion error if metric is not found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric_name</strong> – the name of the matric.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a metric object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(object)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fibber.metrics.MetricBundle.measure_example">
<code class="sig-name descname">measure_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrase</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/metric_utils.html#MetricBundle.measure_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.MetricBundle.measure_example" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the results of all metrics in the bundle for one pair of text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – original text.</p></li>
<li><p><strong>paraphrase</strong> (<em>str</em>) – paraphrased text.</p></li>
<li><p><strong>data_record</strong> (<em>str</em>) – the data record.</p></li>
<li><p><strong>paraphrase_field</strong> (<em>str</em>) – choose from “text0”, “text1”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(dict)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="fibber.metrics.USESemanticSimilarity">
<em class="property">class </em><code class="sig-prename descclassname">fibber.metrics.</code><code class="sig-name descname">USESemanticSimilarity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">use_gpu_id</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/use_semantic_similarity.html#USESemanticSimilarity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.USESemanticSimilarity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fibber.metrics.metric_base.html#fibber.metrics.metric_base.MetricBase" title="fibber.metrics.metric_base.MetricBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">fibber.metrics.metric_base.MetricBase</span></code></a></p>
<p>This metric uses universal sentence encoder to measure the semantic similarity of
two sentences.</p>
<p>Initialize universal sentence encoder.</p>
<dl class="py method">
<dt id="fibber.metrics.USESemanticSimilarity.measure_batch">
<code class="sig-name descname">measure_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrases</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/use_semantic_similarity.html#USESemanticSimilarity.measure_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.USESemanticSimilarity.measure_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the metric on a batch of paraphrases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – the original text.</p></li>
<li><p><strong>paraphrases</strong> (<em>list</em>) – a set of paraphrases.</p></li>
<li><p><strong>data_record</strong> (<em>dict</em>) – the corresponding data record of original text.</p></li>
<li><p><strong>paraphrase_field</strong> (<em>str</em>) – the field name to paraphrase.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list containing the USE similarity metric for each paraphrase.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fibber.metrics.USESemanticSimilarity.measure_example">
<code class="sig-name descname">measure_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrase</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/use_semantic_similarity.html#USESemanticSimilarity.measure_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.USESemanticSimilarity.measure_example" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the cosine similarity between the embedding of original text and paraphrased
text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – original text.</p></li>
<li><p><strong>paraphrase</strong> (<em>str</em>) – paraphrased text.</p></li>
<li><p><strong>data_record</strong> – ignored.</p></li>
<li><p><strong>paraphrase_field</strong> – ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="fibber.metrics.aggregate_metrics">
<code class="sig-prename descclassname">fibber.metrics.</code><code class="sig-name descname">aggregate_metrics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset_name</span></em>, <em class="sig-param"><span class="n">paraphrase_strategy_name</span></em>, <em class="sig-param"><span class="n">experiment_name</span></em>, <em class="sig-param"><span class="n">results</span></em>, <em class="sig-param"><span class="n">customize_aggregation_fn_dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/metric_utils.html#aggregate_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.aggregate_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate paraphrase metrics on a dataset to a summary and store in a dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_name</strong> (<em>str</em>) – the name of the dataset.</p></li>
<li><p><strong>paraphrase_strategy_name</strong> (<em>str</em>) – the name of the paraphrase strategy.</p></li>
<li><p><strong>experiment_name</strong> (<em>str</em>) – the name of the experiment.</p></li>
<li><p><strong>results</strong> (<em>dict</em>) – the fibber dataset with paraphrases and metrics. The return value of
<code class="docutils literal notranslate"><span class="pre">compute_metrics</span></code>.</p></li>
<li><p><strong>customize_aggregation_fn_dict</strong> (<em>dict</em>) – A dict of customized aggregations. The dict is
a mapping from aggregation name to aggregation function. The aggregation function
should take one data_record, and returns a float.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the aggregated metrics.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="fibber.metrics.compute_metrics">
<code class="sig-prename descclassname">fibber.metrics.</code><code class="sig-name descname">compute_metrics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">metric_bundle</span></em>, <em class="sig-param"><span class="n">results</span></em>, <em class="sig-param"><span class="n">output_filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/metric_utils.html#compute_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.compute_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the all metrics for results on a dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_bundle</strong> (<em>object</em>) – a MetricBundle object.</p></li>
<li><p><strong>results</strong> (<em>dict</em>) – A fibber dataset with paraphrases.</p></li>
<li><p><strong>output_filename</strong> (<em>str</em>) – A json filename to store results and metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the results dict with <code class="docutils literal notranslate"><span class="pre">original_text_metrics</span></code> and <code class="docutils literal notranslate"><span class="pre">paraphrase_metrics</span></code> added.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(dict)</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="fibber.datasets.preprocess_yelp.html" title="previous page">fibber.datasets.preprocess_yelp module</a>
    <a class='right-next' id="next-link" href="fibber.metrics.bert_clf_prediction.html" title="next page">fibber.metrics.bert_clf_prediction module</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020, MIT Data To AI Lab.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>