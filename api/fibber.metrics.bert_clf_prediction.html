
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fibber.metrics.bert_clf_prediction module &#8212; fibber 0.1.3 documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/dai-logo-white.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="fibber.metrics.edit_distance module" href="fibber.metrics.edit_distance.html" />
    <link rel="prev" title="fibber.metrics.attack_aggregation module" href="fibber.metrics.attack_aggregation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="../index.html">
    
      <img src="../_static/dai-logo-white-200.png" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../readme.html">Fibber</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href=""></a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../benchmark.html">Benchmark</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="fibber.html">API Reference</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../contributing.html">Contributing</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../authors.html">Credits</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../history.html">History</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/dai-lab/fibber" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          
            
                <li class="">
                    <a href="fibber.benchmark.html">fibber.benchmark package</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.datasets.html">fibber.datasets package</a>
                </li>
            
          
            
  
                <li class="active">
                    <a href="fibber.metrics.html">fibber.metrics package</a>
                    <ul>
                    
                        <li class="">
                            <a href="fibber.metrics.attack_aggregation.html">fibber.metrics.attack_aggregation module</a>
                        </li>
                    
                        <li class="active">
                            <a href="">fibber.metrics.bert_clf_prediction module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.edit_distance.html">fibber.metrics.edit_distance module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.glove_semantic_similarity.html">fibber.metrics.glove_semantic_similarity module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.gpt2_grammar_quality.html">fibber.metrics.gpt2_grammar_quality module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.metric_base.html">fibber.metrics.metric_base module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.metric_utils.html">fibber.metrics.metric_utils module</a>
                        </li>
                    
                        <li class="">
                            <a href="fibber.metrics.use_semantic_similarity.html">fibber.metrics.use_semantic_similarity module</a>
                        </li>
                    
                    </ul>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.paraphrase_strategies.html">fibber.paraphrase_strategies package</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.resources.html">fibber.resources package</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.download_utils.html">fibber.download_utils module</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.fibber.html">fibber.fibber module</a>
                </li>
            
          
            
                <li class="">
                    <a href="fibber.log.html">fibber.log module</a>
                </li>
            
          
        
        
        
        
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="module-fibber.metrics.bert_clf_prediction">
<span id="fibber-metrics-bert-clf-prediction-module"></span><h1>fibber.metrics.bert_clf_prediction module<a class="headerlink" href="#module-fibber.metrics.bert_clf_prediction" title="Permalink to this headline">¶</a></h1>
<p>This metric outputs the BERT classifier prediction of the paraphrased text.</p>
<dl class="py class">
<dt id="fibber.metrics.bert_clf_prediction.BertClfPrediction">
<em class="property">class </em><code class="sig-prename descclassname">fibber.metrics.bert_clf_prediction.</code><code class="sig-name descname">BertClfPrediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset_name</span></em>, <em class="sig-param"><span class="n">trainset</span></em>, <em class="sig-param"><span class="n">testset</span></em>, <em class="sig-param"><span class="n">bert_gpu_id</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">bert_clf_steps</span><span class="o">=</span><span class="default_value">20000</span></em>, <em class="sig-param"><span class="n">bert_clf_bs</span><span class="o">=</span><span class="default_value">32</span></em>, <em class="sig-param"><span class="n">bert_clf_lr</span><span class="o">=</span><span class="default_value">2e-05</span></em>, <em class="sig-param"><span class="n">bert_clf_optimizer</span><span class="o">=</span><span class="default_value">'adamw'</span></em>, <em class="sig-param"><span class="n">bert_clf_weight_decay</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">bert_clf_period_summary</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">bert_clf_period_val</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">bert_clf_period_save</span><span class="o">=</span><span class="default_value">5000</span></em>, <em class="sig-param"><span class="n">bert_clf_val_steps</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.bert_clf_prediction.BertClfPrediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="fibber.metrics.metric_base.html#fibber.metrics.metric_base.MetricBase" title="fibber.metrics.metric_base.MetricBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">fibber.metrics.metric_base.MetricBase</span></code></a></p>
<p>BERT classifier prediction on paraphrases.</p>
<p>This metric is special, it does not compare the original and paraphrased sentence.
Instead, it outputs the classifier prediction on paraphrases. So we should not compute
mean or std on this metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_name</strong> (<em>str</em>) – the name of the dataset.</p></li>
<li><p><strong>trainset</strong> (<em>dict</em>) – a fibber dataset.</p></li>
<li><p><strong>testset</strong> (<em>dict</em>) – a fibber dataset.</p></li>
<li><p><strong>bert_gpu_id</strong> (<em>int</em>) – the gpu id for BERT model. Set -1 to use CPU.</p></li>
<li><p><strong>bert_clf_steps</strong> (<em>int</em>) – steps to train a classifier.</p></li>
<li><p><strong>bert_clf_bs</strong> (<em>int</em>) – the batch size.</p></li>
<li><p><strong>bert_clf_lr</strong> (<em>float</em>) – the learning rate.</p></li>
<li><p><strong>bert_clf_optimizer</strong> (<em>str</em>) – the optimizer name.</p></li>
<li><p><strong>bert_clf_weight_decay</strong> (<em>float</em>) – the weight decay in the optimizer.</p></li>
<li><p><strong>bert_clf_period_summary</strong> (<em>int</em>) – the period in steps to write training summary.</p></li>
<li><p><strong>bert_clf_period_val</strong> (<em>int</em>) – the period in steps to run validation and write validation
summary.</p></li>
<li><p><strong>bert_clf_period_save</strong> (<em>int</em>) – the period in steps to save current model.</p></li>
<li><p><strong>bert_clf_val_steps</strong> (<em>int</em>) – number of batched in each validation.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="fibber.metrics.bert_clf_prediction.BertClfPrediction.measure_batch">
<code class="sig-name descname">measure_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrases</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction.measure_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.bert_clf_prediction.BertClfPrediction.measure_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the metric on a batch of paraphrases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>str</em>) – the original text.</p></li>
<li><p><strong>paraphrases</strong> (<em>list</em>) – a set of paraphrases.</p></li>
<li><p><strong>data_record</strong> (<em>dict</em>) – the corresponding data record of original text.</p></li>
<li><p><strong>paraphrase_field</strong> (<em>str</em>) – the field name to paraphrase.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list containing the metric for each paraphrase.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fibber.metrics.bert_clf_prediction.BertClfPrediction.measure_example">
<code class="sig-name descname">measure_example</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">paraphrase</span></em>, <em class="sig-param"><span class="n">data_record</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">paraphrase_field</span><span class="o">=</span><span class="default_value">'text0'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction.measure_example"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.bert_clf_prediction.BertClfPrediction.measure_example" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="fibber.metrics.bert_clf_prediction.BertClfPrediction.predict_batch">
<code class="sig-name descname">predict_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span></em>, <em class="sig-param"><span class="n">context</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction.predict_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.bert_clf_prediction.BertClfPrediction.predict_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the prediction of the BERT prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>[</em><em>str</em><em>]</em>) – a list of strs to be classified.</p></li>
<li><p><strong>context</strong> (<em>str</em><em> or </em><em>None</em>) – On regular classification datasets, context is None.
On NLI datasets, context contains the premise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the prediction of the classifier.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fibber.metrics.bert_clf_prediction.BertClfPrediction.predict_dist_batch">
<code class="sig-name descname">predict_dist_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span></em>, <em class="sig-param"><span class="n">context</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#BertClfPrediction.predict_dist_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.bert_clf_prediction.BertClfPrediction.predict_dist_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Get log probability of the BERT prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>[</em><em>str</em><em>]</em>) – a list of strs to be classified.</p></li>
<li><p><strong>context</strong> (<em>str</em><em> or </em><em>None</em>) – On regular classification datasets, context is None.
On NLI datasets, context contains the premise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array of the unnormalized log probability over on each category.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(np.array)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="fibber.metrics.bert_clf_prediction.get_optimizer">
<code class="sig-prename descclassname">fibber.metrics.bert_clf_prediction.</code><code class="sig-name descname">get_optimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">optimizer_name</span></em>, <em class="sig-param"><span class="n">lr</span></em>, <em class="sig-param"><span class="n">decay</span></em>, <em class="sig-param"><span class="n">train_step</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">warmup</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#get_optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.bert_clf_prediction.get_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an optimizer and schedule of learning rate for parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer_name</strong> (<em>str</em>) – choose from <code class="docutils literal notranslate"><span class="pre">[&quot;adam&quot;,</span> <span class="pre">&quot;sgd&quot;,</span> <span class="pre">&quot;adamw&quot;]</span></code>.</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – learning rate.</p></li>
<li><p><strong>decay</strong> (<em>float</em>) – weight decay.</p></li>
<li><p><strong>train_step</strong> (<em>int</em>) – number of training steps.</p></li>
<li><p><strong>params</strong> (<em>list</em>) – a list of parameters in the model.</p></li>
<li><p><strong>warmup</strong> (<em>int</em>) – number of warm up steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A torch optimizer and a scheduler.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="fibber.metrics.bert_clf_prediction.load_or_train_bert_clf">
<code class="sig-prename descclassname">fibber.metrics.bert_clf_prediction.</code><code class="sig-name descname">load_or_train_bert_clf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_init</span></em>, <em class="sig-param"><span class="n">dataset_name</span></em>, <em class="sig-param"><span class="n">trainset</span></em>, <em class="sig-param"><span class="n">testset</span></em>, <em class="sig-param"><span class="n">bert_clf_steps</span></em>, <em class="sig-param"><span class="n">bert_clf_bs</span></em>, <em class="sig-param"><span class="n">bert_clf_lr</span></em>, <em class="sig-param"><span class="n">bert_clf_optimizer</span></em>, <em class="sig-param"><span class="n">bert_clf_weight_decay</span></em>, <em class="sig-param"><span class="n">bert_clf_period_summary</span></em>, <em class="sig-param"><span class="n">bert_clf_period_val</span></em>, <em class="sig-param"><span class="n">bert_clf_period_save</span></em>, <em class="sig-param"><span class="n">bert_clf_val_steps</span></em>, <em class="sig-param"><span class="n">device</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#load_or_train_bert_clf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.bert_clf_prediction.load_or_train_bert_clf" title="Permalink to this definition">¶</a></dt>
<dd><p>Train BERT classification model on a dataset.</p>
<p>The trained model will be stored at <code class="docutils literal notranslate"><span class="pre">&lt;fibber_root_dir&gt;/bert_clf/&lt;dataset_name&gt;/</span></code>. If there’s
a saved model, load and return the model. Otherwise, train the model using the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_init</strong> (<em>str</em>) – pretrained model name. Choose from <code class="docutils literal notranslate"><span class="pre">[&quot;bert-base-cased&quot;,</span>
<span class="pre">&quot;bert-base-uncased&quot;,</span> <span class="pre">&quot;bert-large-cased&quot;,</span> <span class="pre">&quot;bert-large-uncased&quot;]</span></code>.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – the name of the dataset. This is also the dir to save trained model.</p></li>
<li><p><strong>trainset</strong> (<em>dict</em>) – a fibber dataset.</p></li>
<li><p><strong>testset</strong> (<em>dict</em>) – a fibber dataset.</p></li>
<li><p><strong>bert_clf_steps</strong> (<em>int</em>) – steps to train a classifier.</p></li>
<li><p><strong>bert_clf_bs</strong> (<em>int</em>) – the batch size.</p></li>
<li><p><strong>bert_clf_lr</strong> (<em>float</em>) – the learning rate.</p></li>
<li><p><strong>bert_clf_optimizer</strong> (<em>str</em>) – the optimizer name.</p></li>
<li><p><strong>bert_clf_weight_decay</strong> (<em>float</em>) – the weight decay.</p></li>
<li><p><strong>bert_clf_period_summary</strong> (<em>int</em>) – the period in steps to write training summary.</p></li>
<li><p><strong>bert_clf_period_val</strong> (<em>int</em>) – the period in steps to run validation and write validation
summary.</p></li>
<li><p><strong>bert_clf_period_save</strong> (<em>int</em>) – the period in steps to save current model.</p></li>
<li><p><strong>bert_clf_val_steps</strong> (<em>int</em>) – number of batched in each validation.</p></li>
<li><p><strong>device</strong> (<em>torch.Device</em>) – the device to run the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a torch BERT model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(transformers.BertForSequenceClassification)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="fibber.metrics.bert_clf_prediction.run_evaluate">
<code class="sig-prename descclassname">fibber.metrics.bert_clf_prediction.</code><code class="sig-name descname">run_evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">dataloader_iter</span></em>, <em class="sig-param"><span class="n">eval_steps</span></em>, <em class="sig-param"><span class="n">summary</span></em>, <em class="sig-param"><span class="n">global_step</span></em>, <em class="sig-param"><span class="n">device</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fibber/metrics/bert_clf_prediction.html#run_evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fibber.metrics.bert_clf_prediction.run_evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a model and add error rate and validation loss to Tensorboard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>transformers.BertForSequenceClassification</em>) – a BERT classification model.</p></li>
<li><p><strong>dataloader_iter</strong> (<em>torch.IterableDataset</em>) – an iterator of a torch.IterableDataset.</p></li>
<li><p><strong>eval_steps</strong> (<em>int</em>) – number of training steps.</p></li>
<li><p><strong>summary</strong> (<em>torch.utils.tensorboard.SummaryWriter</em>) – a Tensorboard SummaryWriter object.</p></li>
<li><p><strong>global_step</strong> (<em>int</em>) – current training steps.</p></li>
<li><p><strong>device</strong> (<em>torch.Device</em>) – the device where the model in running on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="fibber.metrics.attack_aggregation.html" title="previous page">fibber.metrics.attack_aggregation module</a>
    <a class='right-next' id="next-link" href="fibber.metrics.edit_distance.html" title="next page">fibber.metrics.edit_distance module</a>

              </div>
              
          </main>
          

      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020, MIT Data To AI Lab.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>